<!DOCTYPE html>
<HTML lang="de">

<HEAD>
    <TITLE>....</TITLE>
    <meta name="description" content="....">
    <meta name="keywords" content="...">
    <meta name="HandheldFriendly" content="true">
    <meta name="google-site-verification" content="BEq7yWqksTB4rBtUzG6qVYfhCm40JNbNWjpS537OnWo">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link href='https://fonts.googleapis.com/css?family=Exo+2:light,regular,medium,thin,italic,mediumitalic,bold'
        rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://d3js.org/d3.v4.min.js" type=text/javascript></script>
    <script src=https://code.jquery.com/jquery-3.4.1.min.js type=text/javascript></script>
    <script src=js/locations.js type=text/javascript></script>
    <script src=js/parameters.js type=text/javascript></script>
    <script src=js/actions.js type=text/javascript></script>
    <script src=js/graphs.js type=text/javascript></script>

    <script>
        
        // Week number according to the ISO-8601 standard
        Date.prototype.getWeek = function () {
            var target = new Date(this.valueOf());
            var dayNr = (this.getDay() + 6) % 7;
            target.setDate(target.getDate() - dayNr + 3);
            var firstThursday = target.valueOf();
            target.setMonth(0, 1);
            if (target.getDay() != 4) {
                target.setMonth(0, 1 + ((4 - target.getDay()) + 7) % 7);
            }
            return 1 + Math.ceil((firstThursday - target) / 604800000);
        }

        function showFirstActionInterval(target) {
            var elem_div = document.getElementById("action" + target);
            var elem_input = document.getElementById("input_action" + target);

            if (elem_input.checked) {
                showInterval("action" + target, 0);
            } else {
                hideAll("action" + target + "_");
            }
        }


        function showInterval(target_name, number) {

            var elem = document.getElementById(target_name + "_" + number);

            if (elem.style.display == "none") {
                elem.style.display = "block";
            }
        }

        function hideAll(target_name) {

            for (var i = 0; i < 4; i++) {
                var elem = document.getElementById(target_name + "" + i);

                elem.checked = false;
                elem.style.display = "none";
            }

        }

        // var actions = new Array("HomeOffice Empfehlung", "HomeOffice Anordnung", "Schlie&szlig;ung von Restaurant und Bars", "Schlie&szlig;ung von Gesch&auml;ften",
        //     "Schulschlie&szlig;ungen", "Kontaktverbot", "Ausgangssperre", "Einreiseverbote", "Systematisierung von Tests");

        var actions = new Array();

        function init() {
            document.getElementById('button').addEventListener('click', changeHTMLContent);
        }

        function changeHTMLContent() {
            var neu = "neuer <b>fetter</b> Text";
            document.getElementById('absatz').innerHTML = neu;
        }

        

        $(function(){
            let $container = $('.actions .content');
            let locations = new Locations("#locations");
            let parameters = new Parameters($('#parameters'));
            let actions = new Actions($container, [
                "HomeOffice", 
                "Schlie&szlig;ung von XYZ", 
                "Schulschlie&szlig;ungen", 
                "Kontaktverbot", 
                "Ausgangssperre"
            ]);

            $('svg#graphs')
                .attr('width', $('svg#graphs').width())
                .attr('height', $('svg#graphs').height());

            let graphs = new Graphs("svg#graphs");

            locations.onselect((arg) => {
                graphs.visualize(arg);
            });

            actions.onchange((actions) => {
                graphs.updateActions(actions);
            });

            $('button.refresh')
                .click(function(event) {
                    event.preventDefault();
                    event.stopPropagation();

                    let p = parameters.getParameters();
                    console.log(p);
                });
        });
    </script>

    <style type=text/css>
        body {
            background-color: #FFFFFF
        }

        .wrapper {
            width: 90%;
            padding: 3%
        }

        .wrapper ul {
            margin: 0;
            padding: 0;
            text-decoration: none;
            list-style: none;
        }

        .wrapper ul li {
            margin: 5px 5px 5px 10px;
        }

        .wrapper ul li:last-child {
            margin-bottom: 10px !important;
        }

        .wrapper .box {
            position: relative;
            border: 1px #cdcdcd solid;
            border-radius: 10px;
            margin-right: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .wrapper>div {
            float: left;
        }

        .wrapper .settings,
        .wrapper .locations {
            width: 300px;
        }

        .wrapper .graphs {
            width: 930px;
        }

        .wrapper .locations,
        .wrapper .graphs {
            height: 610px
        }

        .wrapper .actions,
        .wrapper .parameters {
            height: 300px;
        }

        .wrapper .actions .content,
        .wrapper .parameters .content {
            padding: 10px;
        }

        .wrapper .box .heading {
            padding: 7px 7px 7px 15px;
            height: 26px;
            font-weight: bold;
            background-color: rgb(115, 176, 255);
            vertical-align: middle;
            line-height: 22px;
        }

        .wrapper .box .content {
            position: relative;
        }

        .wrapper .box .buttons {
            text-align: right;
            padding: 5px 15px 5px;
            height: 40px;
        }

        .wrapper .locations svg {
            height: 570px;
            width: 300px;
        }

        .wrapper .graphs svg {
            width: 930px;
            height: 520px;
            border-top: 1px solid #cdcdcd;
        }

    </style>

</HEAD>

<body>

    <template id=template-action>
        <div class=action>
            <input type='checkbox'>
            <span class=name>actions[i]</span>
            <ul class=intervals></ul>
        </div>
    </template>

    <template id=template-time-interval>
        <li class=time-interval>
            <input type='checkbox'>
            <input class=start size=8 value="">
            -
            <input class=end size=8 value="">
        </li>
    </template>

    <div class=wrapper>

        <div class="box locations">
            <div class=heading>Orte</div>
            <div class=content>
                <svg id=locations></svg>
            </div>
        </div>

        <div class=settings>
            <div class="box actions">
                <div class=heading>Ma√ünahmen</div>
                <div class=content>

                </div>
            </div>

            <div class="box parameters">
                <div class=heading>Parameter</div>
                <div class=content>
                    <form id=parameters name=parameters>
                    <table>
                        <tr>
                            <td>R0</td>
                            <td><input size="4" value="2.7" name=r0></td>
                        </tr>
                        <tr>
                            <td>Inkubationszeit</td>
                            <td><input size="4" value="5" name=incubation></td>
                        </tr>
                        <tr>
                            <td>Infektionszeit</td>
                            <td><input size="4" value="4" name=infection></td>
                        </tr>
                        <tr>
                            <td>Behandlungsdauer</td>
                            <td><input size="4" value="4" name=treatment></td>
                        </tr>
                        <tr>
                            <td>Beatmungsdauer</td>
                            <td><input size="4" value="10" name=respiration></td>
                        </tr>
                        <tr>
                            <td>Anzahl Intensivbetten</td>
                            <td><input size="4" value="10000" name=beds></td>
                        </tr>
                        <tr>
                            <td>Parameter X</td>
                            <td><input size="4" value="12" name=px></td>
                        </tr>
                        <tr>
                            <td>Parameter Y</td>
                            <td><input size="4" value="24" name=py></td>
                        </tr>
                        <tr>
                            <td>Parameter Z</td>
                            <td><input size="4" value="36" name=pz></td>
                        </tr>
                    </table>
                    </form>
                </div>
            </div>
        </div>

        <div class="box graphs">
            <div class=heading>Verlauf</div>
            <div class=buttons>
                <button class='refresh'>Aktualisieren</button>
                <button class='y-linear'>y-linear</button>
                <button class='y-log'>y-log</button>
            </div>
            <div class=content>
                <svg id=graphs></svg>
            </div>
        </div>

    </div>

        <!-- <button onclick="read_and_visualize('covid19_ger_rand.csv',false)">K&ouml;ln</button>

            <button onclick="read_and_visualize('covid19_ger.csv',false)">K&ouml;ln</button> -->
        <!-- <div id="actions" style="width:100%; position:relative; float:left;">

                <script>
                    var d = new Date();

                    var content = '<h3>Ma&szlig;nahmen</h3>';
                    for (var i = 0; i < actions.length; i++) {
                        //   <input type='checkbox' name='action[]' value='2'><br>
                        content += "<div id='action" + i + "'>";
                        content += "<input id='input_action" + i + "' onClick='showFirstActionInterval(" + i + ")' type='checkbox' name='action[]' value='" + i + "'> " + actions[i];
                        for (var j = 0; j < 4; j++) {
                            content += "<div id='action" + i + "_" + j + "' style='display:none;'>";
                            content += "von KW <input id='action" + i + "_" + j + "_start' size='6'";
                            if (j == 0) {
                                content += "value='" + d.getFullYear() + ":" + d.getWeek() + "''";
                            } else {
                                content += "value='" + d.getFullYear() + ":'";
                            }
                            content += "> bis KW <input id='action" + i + "_" + j + "_end' size='6'";
                            if (j == 0) {
                                content += "value='" + d.getFullYear() + ":" + (d.getWeek() + 2) + "''";
                            } else {
                                content += "value='" + d.getFullYear() + ":'";
                            }
                            content += "></div>";
                        }
                        content += "</div>";
                    }
                    document.getElementById("actions").innerHTML = content;
                </script>
            </div> -->

        <!-- </div> -->

</body>

</HTML>