<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HPC against Corona: memilio.epidata.getDIVIData Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HPC against Corona
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacememilio.html">memilio</a></li><li class="navelem"><a class="el" href="namespacememilio_1_1epidata.html">epidata</a></li><li class="navelem"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html">getDIVIData</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">memilio.epidata.getDIVIData Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad28f5f783786bd6122ae640761671b30"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#ad28f5f783786bd6122ae640761671b30">adjust_data</a> (df, date_of_data)</td></tr>
<tr class="memdesc:ad28f5f783786bd6122ae640761671b30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjusts data such that the data structure looks the same for all dates.  <a href="namespacememilio_1_1epidata_1_1getDIVIData.html#ad28f5f783786bd6122ae640761671b30">More...</a><br /></td></tr>
<tr class="separator:ad28f5f783786bd6122ae640761671b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82558240470902ad43f0f28abc1a2e48"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#a82558240470902ad43f0f28abc1a2e48">call_call_url</a> (url_prefix, call_number)</td></tr>
<tr class="memdesc:a82558240470902ad43f0f28abc1a2e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls, if possible a url and breaks if it is not possible to call the url, e.g., due to a not working internet connection or returns an empty dataframe if url is not the correct one.  <a href="namespacememilio_1_1epidata_1_1getDIVIData.html#a82558240470902ad43f0f28abc1a2e48">More...</a><br /></td></tr>
<tr class="separator:a82558240470902ad43f0f28abc1a2e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d0e26e1b696338f7d05c6c18f98115"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#a40d0e26e1b696338f7d05c6c18f98115">download_data_for_one_day</a> (last_number, download_date)</td></tr>
<tr class="memdesc:a40d0e26e1b696338f7d05c6c18f98115"><td class="mdescLeft">&#160;</td><td class="mdescRight">Downloads data for given date.  <a href="namespacememilio_1_1epidata_1_1getDIVIData.html#a40d0e26e1b696338f7d05c6c18f98115">More...</a><br /></td></tr>
<tr class="separator:a40d0e26e1b696338f7d05c6c18f98115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e160f4063366bd6f0a24366fbab8e1b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#a7e160f4063366bd6f0a24366fbab8e1b">get_divi_data</a> (read_data=dd.defaultDict['read_data'], file_format=dd.defaultDict['file_format'], out_folder=dd.defaultDict['out_folder'], no_raw=dd.defaultDict['no_raw'], end_date=dd.defaultDict['end_date'], start_date=dd.defaultDict['start_date'], update_data=dd.defaultDict['update_data'])</td></tr>
<tr class="memdesc:a7e160f4063366bd6f0a24366fbab8e1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to get the divi data.  <a href="namespacememilio_1_1epidata_1_1getDIVIData.html#a7e160f4063366bd6f0a24366fbab8e1b">More...</a><br /></td></tr>
<tr class="separator:a7e160f4063366bd6f0a24366fbab8e1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1faf4553909b23b75e083cd2ef74d263"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#a1faf4553909b23b75e083cd2ef74d263">main</a> ()</td></tr>
<tr class="separator:a1faf4553909b23b75e083cd2ef74d263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141d8deff37441e63bb4c22926a56830"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememilio_1_1epidata_1_1getDIVIData.html#a141d8deff37441e63bb4c22926a56830">nearest_earlier_date</a> (date_list, date_given)</td></tr>
<tr class="memdesc:a141d8deff37441e63bb4c22926a56830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds nearest but earlier date to a given date from a list of dates.  <a href="namespacememilio_1_1epidata_1_1getDIVIData.html#a141d8deff37441e63bb4c22926a56830">More...</a><br /></td></tr>
<tr class="separator:a141d8deff37441e63bb4c22926a56830"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad28f5f783786bd6122ae640761671b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28f5f783786bd6122ae640761671b30">&#9670;&nbsp;</a></span>adjust_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.adjust_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>date_of_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjusts data such that the data structure looks the same for all dates. </p>
<p>For the first available dates of year 2020, there are some differences and thus special treatment is needed:</p><ul>
<li>April 24, 2020.: Rename column 'kreis' to 'gemeindeschluessel'</li>
<li>April 25, 2020.: Add id bundesland, which is extracted from the given column "gemeindeschluessel"</li>
<li>April 24-27, 2020.: Add date as a column</li>
<li>April 29, 2020.: Empty column has to be removed</li>
<li>Before March 31, 2021 rename faelle_covid_aktuell_beatmet' to 'faelle_covid_aktuell_invasiv_beatmet'</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">df</td><td>A pandas data frame </td></tr>
    <tr><td class="paramname">date_of_data</td><td>The date for the data stored in df </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>changed pandas dataframe </dd></dl>

</div>
</div>
<a id="a82558240470902ad43f0f28abc1a2e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82558240470902ad43f0f28abc1a2e48">&#9670;&nbsp;</a></span>call_call_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.call_call_url </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>url_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>call_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls, if possible a url and breaks if it is not possible to call the url, e.g., due to a not working internet connection or returns an empty dataframe if url is not the correct one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url_prefix</td><td>Date specific part of the url </td></tr>
    <tr><td class="paramname">call_number</td><td>Irregular number which is needed for the url</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pandas dataframe which is either empty or contains requested data </dd></dl>

</div>
</div>
<a id="a40d0e26e1b696338f7d05c6c18f98115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d0e26e1b696338f7d05c6c18f98115">&#9670;&nbsp;</a></span>download_data_for_one_day()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.download_data_for_one_day </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>last_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>download_date</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Downloads data for given date. </p>
<p>This function checks if the given date is a key of a dictionary where dates and their corresponding call_numbers are stored. This is stored there if the difference of the call_number to the call_number of the date before is larger than 1 or 2. If the date is not part of the call_number_dict the new call_number is calculated. First, the last_number is successively increased by one until a difference of 300 is reached. Then, the last_number is successively decreased by one until a difference of 300 is reached. At last the last_number without a change is tried. If data could be downloaded by the function call_call_url and the difference was 1 or 2, the data is simply given back. If the difference is different an additional message is printed in the end of the program, which can be used to copy the date and the corresponding call_number directly into the call_number_dict to decrease runtime of the program. Furthermore, in this function another specific part of the url, the call_time, is estimated from the given date. If the date is before 2020-6-5 the time "-09-15" and afterwards "-12-15" has to be added to the date. Moreover for dates in the range [2020-6-12, 2020-6-5], an additional "-2" has to be added after the call_time. Thus, the url_prefix = call_date + call_time + ext and is then given to the call_call_url fct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">last_number</td><td>This is the call_number which is needed for the download url of the date 1 day before this one </td></tr>
    <tr><td class="paramname">download_date</td><td>The date for which the data should be downloaded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of call_number of the download_data, the pandas dataframe, and a string which is either empty or contains what should be added to "call_number_dict" </dd></dl>

</div>
</div>
<a id="a7e160f4063366bd6f0a24366fbab8e1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e160f4063366bd6f0a24366fbab8e1b">&#9670;&nbsp;</a></span>get_divi_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.get_divi_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_data</em> = <code>dd.defaultDict['read_data']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>file_format</em> = <code>dd.defaultDict['file_format']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out_folder</em> = <code>dd.defaultDict['out_folder']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>no_raw</em> = <code>dd.defaultDict['no_raw']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>end_date</em> = <code>dd.defaultDict['end_date']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_date</em> = <code>dd.defaultDict['start_date']</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>update_data</em> = <code>dd.defaultDict['update_data']</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to get the divi data. </p>
<p>Available data start from 2020-4-24. If the given start_date is earlier, it is changed to this date and a warning is printed. If it does not already exist, the folder Germany is generated in the given out_folder. If read_data == True and the file "FullData_DIVI.json" exists, the data is read form this file and stored in a pandas dataframe. Otherwise the program is stopped.</p>
<p>If update_data == True the same happens as for read_data == True. Furthermore, if the last date in read data is yesterday, the data of today is downloaded. For this download an easier link can be used than the one where we have to find the mysterious call_number. If the data has not yet been uploaded, the program is stopped with a message to try again later. If there is more data missing than today, the parameter start_date is changed to the first missing data, and the data is normally downloaded (see below).</p>
<p>If data should normally be downloaded between start_date and end_date, we start with an empty pandas dataframe. Afterwards, for every day between start_date and end_date, both included, the function download_data_for_one_day is called. If a given back dataframe is empty, a warning is printed that this date is missing, but the program is not stopped. If start_date is earlier or equal 2020-04-29, the function adjust_data has to be called. If data has been downloaded, the dataframe of this one date is added to the dataframe with all dates.</p>
<p>If the dataframe which should contain all data is empty after going through all dates, the program is stopped. Otherwise the dataframe is written to the file filename = "FullData_DIVI". Than the columns are renamed to English and the state and county names are added. Afterwards, three kinds of structuring of the data are done. We obtain the chronological sequence of ICU and ICU_ventilated stored in the files "county_divi".json", "state_divi.json"and "germany_divi.json" for counties, states and whole Germany, respectively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">read_data</td><td>False [Default] or True. Defines if data is read from file or downloaded. </td></tr>
    <tr><td class="paramname">file_format</td><td>File format which is used for writing the data. Default defined in <a class="el" href="namespacememilio_1_1epidata_1_1defaultDict.html">defaultDict</a>. </td></tr>
    <tr><td class="paramname">update_data</td><td>"True" if existing data is updated or "False [Default]" if it is downloaded for all dates from start_date to end_date. </td></tr>
    <tr><td class="paramname">out_folder</td><td>Folder where data is written to. </td></tr>
    <tr><td class="paramname">no_raw</td><td>True or False [Default]. Defines if unchanged raw data is saved or not. </td></tr>
    <tr><td class="paramname">start_date</td><td>[Optional] Date to start to download data [Default = 2020.4.24]. </td></tr>
    <tr><td class="paramname">end_date</td><td>[Optional] Date to stop to download data [Default = today]. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1faf4553909b23b75e083cd2ef74d263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1faf4553909b23b75e083cd2ef74d263">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Main program entry.</pre> 
</div>
</div>
<a id="a141d8deff37441e63bb4c22926a56830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141d8deff37441e63bb4c22926a56830">&#9670;&nbsp;</a></span>nearest_earlier_date()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def memilio.epidata.getDIVIData.nearest_earlier_date </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>date_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>date_given</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds nearest but earlier date to a given date from a list of dates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">date_list</td><td>Iterable object of dates </td></tr>
    <tr><td class="paramname">date_given</td><td>Single date</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>date from date_list which is closest but earlier to date_given. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
